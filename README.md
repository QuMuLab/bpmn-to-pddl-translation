# BPMN-to-PDDL Translator

This project translates BPMN 2.0 process models into PDDL (Planning Domain Definition Language) scripts that can be used with automated planners to simulate or reason about business processes.

##  Purpose

Business Process Model and Notation (BPMN) is a widely used standard for representing workflows. Planning Domain Definition Language (PDDL) is the standard input for many AI planners.

This project bridges the two by:
- Parsing a BPMN 2.0 diagram.
- Generating a PDDL domain file with all process actions.
- Generating a PDDL problem file with the initial state and goal.

##  Features

- Parses BPMN 2.0 elements (tasks, events, gateways, flows).
- Handles exclusive, parallel, inclusive, and event-based gateways.
- Supports start and end events.
- Outputs PDDL domain and predicates and permutations of each start and end event as problem files.

## How to Run

The script `read_bpmn_task_v2.py` is the current and most updated version of the script. When running the script, simply type the file name and press Enter. For example: `Enter file name (no path): self_serve_restaurant.bpmn`. This will create a folder named after the file's name, and then place the generated domain files and problem files into a folder within that created folder called `not_flattened`.

To generate a policy for your domain, first start by making sure you have Docker installed. https://docs.docker.com/engine/install/ 

Then, in a command prompt, navigate to the directory with all of the scripts and make sure to pull the image for `planutils` by running `docker pull cjmuise/cisc813`. Now navigate to the directory with your generated domain and problem files and run the command `docker run -it --privileged -v $(pwd):/root/cisc813 cjmuise/cisc813`. Now you can run the command `planutils remote prppp dom.pddl prob.pddl` to generate your policy. Note that there is only one domain generated by the original script, but there may be multiple problem files generated depending on the number of start and end events in your given BPMN diagram. The problem file named `p0.pddl` is the default problem file where using the non-determinism of PR2, each start event is explored, but the other problem files will be the different permutations of start and end events. To know that the PDDL is valid, you should see the output at the bottom say 'Strong cyclic solution found.'. If you don't see that, either your PDDL is not valid and there's a bug in my code, or there is something wrong with planutils, and you should contact Christian Muise.

To generate a graphic of the policy, just run the command `prpviz policy.out` and the visualization of your policy will be generated and displayed in a file called `graph.png` within the same directory as your domain and problem file.

## Logic

To understand the logic behind some of the code, as well as some key problems with it right now, please review this slideshow: https://docs.google.com/presentation/d/13gbRBdSbhra8sJCkrnBR50CVKcPenhqUc2hdqMthqKU/edit?usp=sharing.

## Other Scripts

`read_bpmn_tasks_no_flatten.py` is an older version of the script that lacks many features; please ignore this script.

`read_bpmn_tasks.py` is an older version of the script that "flattens" a BPMN diagram; however, this is not necessary anymore since we are able to use the non-determinism of PR2.

`save.py` is a current version of the script with the semantically correct interpretation of message flows (refer to slide 32 on the Google Slides linked above).
